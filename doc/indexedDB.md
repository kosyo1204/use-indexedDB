# IndexedDBの主な特徴

## 概要
- ユーザーのブラウザ内にデータを永続的に保存する手段。
- ネットワークの状態に関わらず、オンライン、オフラインの両方で動作する。
- キーに基づいてインデックス化されたオブジェクトを保存、取得できる。
- DBへの変更は全てトランザクション内で行われる。
- 同一オリジンポリシーに従うため、異なるドメイン間のデータにはアクセスできない。

## 主な特徴
- キーと値の組みを格納する。
- トランザクションデータベースモデルに基づいて構築される。
  トランザクション外でコマンドを実行したり、カーソルを開くことはできない。例外が生じる。自動コミットされる。手動は不可。
  →二つのタブで開いたときに有用。トランザクション操作があるので、互いの変更に干渉しない。
- ほとんどが非同期。
  APIは値を返すことでデータを提供するのではなく、コールバック関数を渡す必要がある。
  ＝DBから値を取り出したり、格納するときは同期的に行うわけではない。DBの操作をリクエストする。
  操作が終わるとDOMイベントで通知され、そのイベントの種類で操作の成功/失敗を判断する。
- たくさんのリクエストを使う。
  リクエストとは、前述の成功、失敗のDOMイベントを受け取るオブジェクト。
- DOMイベントを使い、結果が利用可能になったことを通知する。
  成功イベントはバブルアップ、キャンセルできない。
  エラーイベントはバブリングするし、キャンセルもできる。キャンセルされない限り、実行中のトランザクションを中断する。
- オブジェクト指向
  行と列の集合体であるテーブルを持つ、RDBではない。
  データの種類に応じてオブジェクトストアを作成し、そのストアにJSオブジェクトを永続化する必要がある。
- SQLを用いない。
  インデックスに対するクエリーを使ってカーソルを生成し、そのカーソルを使って結果セットを反復処理する。＝NoSQL
- 同一オリジンポリシー

## 制限事項
- 国際化に対応した並べ替えは不可。
- 同期通信はできない。
- 全文検索はできない。

また、以下の条件でブラウザがDBを削除することがある。
- ユーザーが消去を要求した場合。
- ディスクの容量上限に達した場合
- データの破損。
- 互換性のない変更が行われた場合

- firefox では動かない事例がありそう。
- インデックスは、参照オブジェクトストアと呼ばれる別のオブジェクトストアにあるレコードを探すために特化したオブジェクトストア

## 参考記事
https://developer.mozilla.org/ja/docs/Web/API/IndexedDB_API/Basic_Terminology


# IndexedDBの使用

## 基本パターン
1. DBを開く
2. DB内にオブジェクトストアを作成する
3. データ追加や取得といったDB操作のトランザクションを開始し、リクエストを行う。
4. 適切なDOMイベントを受け取り、操作完了を待つ。
5. 結果（リクエストオブジェクトにある）に応じた処理を行う。

## ストアの作成および構築

詳細が解説されている。今回はDexie.jsを利用するので、
その使い方で不明点があれば、ここを参照すれば良いと考える。
一旦スキップ。

